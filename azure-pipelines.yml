# Maven
# Build your Java project and run tests with Apache Maven.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/java

trigger:
- none

name: $(Date:yyyyMMdd)$(Rev:.r)
resources:
  repositories:
  - repository: templatesRepo
    type: GitHub
    endpoint: radoscis  
    name: radoscis/pipelines-templates

stages:
- stage: build
  jobs:
  - job: checkOutTemplateRepos
    steps:
    - checkout: templatesRepo
  - job: buildWithMaven
    variables: 
    - template: /vars/platforms_jdks.yml
    strategy:
      matrix:
        linux_jdk_10:
          imageName: ${{ variables.linux_jdk_10_imageName }}
          jdk_version: ${{ variables.linux_jdk_10_jdk_version  }}
        linux_jdk_11:
          imageName: ${{ variables.linux_jdk_11_imageName }}
          jdk_version: ${{ variables.linux_jdk_11_jdk_version }}
      maxParallel: 1
    pool: 
      vmImage: $(imageName)
    steps:
    - template: steps/java.maven.yml@templatesRepo
      parameters:
        jdk_version: $(jdk_version)